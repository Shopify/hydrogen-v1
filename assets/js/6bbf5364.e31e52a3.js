"use strict";(self.webpackChunkdocs_v_1=self.webpackChunkdocs_v_1||[]).push([[5334],{3905:(e,n,t)=>{t.d(n,{Zo:()=>c,kt:()=>h});var o=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,o,a=function(e,n){if(null==e)return{};var t,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)t=r[o],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)t=r[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var i=o.createContext({}),p=function(e){var n=o.useContext(i),t=n;return e&&(t="function"==typeof e?e(n):s(s({},n),e)),t},c=function(e){var n=p(e.components);return o.createElement(i.Provider,{value:n},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return o.createElement(o.Fragment,{},n)}},m=o.forwardRef((function(e,n){var t=e.components,a=e.mdxType,r=e.originalType,i=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=p(t),m=a,h=d["".concat(i,".").concat(m)]||d[m]||u[m]||r;return t?o.createElement(h,s(s({ref:n},c),{},{components:t})):o.createElement(h,s({ref:n},c))}));function h(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var r=t.length,s=new Array(r);s[0]=m;var l={};for(var i in n)hasOwnProperty.call(n,i)&&(l[i]=n[i]);l.originalType=e,l[d]="string"==typeof e?e:a,s[1]=l;for(var p=2;p<r;p++)s[p]=t[p];return o.createElement.apply(null,s)}return o.createElement.apply(null,t)}m.displayName="MDXCreateElement"},8237:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>i,contentTitle:()=>s,default:()=>u,frontMatter:()=>r,metadata:()=>l,toc:()=>p});var o=t(7462),a=(t(7294),t(3905));const r={},s="Fetch storefront data",l={unversionedId:"tutorials/getting-started/tutorial/fetch-data",id:"tutorials/getting-started/tutorial/fetch-data",title:"Fetch storefront data",description:"Hydrogen 2.0 is out now. These archival Hydrogen 1.0 docs are provided only to assist developers during their upgrade process. Please migrate to Hydrogen 2.0 as soon as possible.",source:"@site/docs/tutorials/getting-started/tutorial/fetch-data.md",sourceDirName:"tutorials/getting-started/tutorial",slug:"/tutorials/getting-started/tutorial/fetch-data",permalink:"/hydrogen-v1/tutorials/getting-started/tutorial/fetch-data",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"hydrogen",previous:{title:"Build a collection page",permalink:"/hydrogen-v1/tutorials/getting-started/tutorial/collections"},next:{title:"Build a product page",permalink:"/hydrogen-v1/tutorials/getting-started/tutorial/products"}},i={},p=[{value:"Scenario",id:"scenario",level:2},{value:"What you\u2019ll learn",id:"what-youll-learn",level:2},{value:"Requirements",id:"requirements",level:2},{value:"Sample code",id:"sample-code",level:2},{value:"Step 1: Visit the GraphiQL explorer",id:"step-1-visit-the-graphiql-explorer",level:2},{value:"Step 2: Move the query into your Hydrogen app",id:"step-2-move-the-query-into-your-hydrogen-app",level:2},{value:"Create a <code>Layout</code> component",id:"create-a-layout-component",level:3},{value:"Step 3: Generate SEO tags",id:"step-3-generate-seo-tags",level:2},{value:"Step 4: Fetch collections",id:"step-4-fetch-collections",level:2},{value:"Create a <code>FeaturedCollections</code> component",id:"create-a-featuredcollections-component",level:3},{value:"Fetch collection images",id:"fetch-collection-images",level:3},{value:"Step 5: Improve the loading sequence with Suspense",id:"step-5-improve-the-loading-sequence-with-suspense",level:2},{value:"Next steps",id:"next-steps",level:2}],c={toc:p},d="wrapper";function u(e){let{components:n,...t}=e;return(0,a.kt)(d,(0,o.Z)({},c,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"fetch-storefront-data"},"Fetch storefront data"),(0,a.kt)("admonition",{type:"tip"},(0,a.kt)("p",{parentName:"admonition"},"Hydrogen 2.0 is out now. These archival Hydrogen 1.0 docs are provided only to assist developers during their upgrade process. Please ",(0,a.kt)("a",{parentName:"p",href:"https://shopify.dev/docs/custom-storefronts/hydrogen/migrate-hydrogen-remix"},"migrate to Hydrogen 2.0")," as soon as possible.")),(0,a.kt)("p",null,"Previously, you ",(0,a.kt)("a",{parentName:"p",href:"/tutorials/getting-started/tutorial/begin/"},"began developing a Hydrogen storefront"),". You have a minimal Hydrogen storefront running locally. You\u2019re now ready to fetch data from your storefront."),(0,a.kt)("p",null,"In this tutorial, you'll connect your Hydrogen app to your storefront and fetch data using the ",(0,a.kt)("a",{parentName:"p",href:"https://shopify.dev/api/storefront"},"Storefront API"),"."),(0,a.kt)("h2",{id:"scenario"},"Scenario"),(0,a.kt)("p",null,"You want to retrieve specific data from your storefront, including your store\u2019s name and collections. You know that you'll use the Storefront API, which allows you to build custom shopping experiences. The Storefront API makes it possible for customers to view products and collections, add products to a cart, and check out."),(0,a.kt)("h2",{id:"what-youll-learn"},"What you\u2019ll learn"),(0,a.kt)("p",null,"In this tutorial, you\u2019ll learn how to do the following tasks:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Make a GraphQL query using the ",(0,a.kt)("a",{parentName:"li",href:"https://shopify.dev/docs/custom-storefronts/tools/graphiql-storefront-api"},"Shopify Storefront API GraphiQL explorer"),"."),(0,a.kt)("li",{parentName:"ul"},"Implement the ",(0,a.kt)("a",{parentName:"li",href:"/hooks/global/useshopquery/"},"useShopQuery")," hook to fetch storefront data from inside your Hydrogen app."),(0,a.kt)("li",{parentName:"ul"},"Generate default SEO tags."),(0,a.kt)("li",{parentName:"ul"},"Improve the loading sequence of your app using Suspense.")),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://shopify.dev/assets/custom-storefronts/hydrogen/hydrogen-fetch-data.png",alt:"A collections page, GraphQL query, and SEO tags"})),(0,a.kt)("h2",{id:"requirements"},"Requirements"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"You\u2019ve completed the ",(0,a.kt)("a",{parentName:"li",href:"/tutorials/getting-started/tutorial/begin/"},"Begin developing a Hydrogen storefront")," tutorial.")),(0,a.kt)("h2",{id:"sample-code"},"Sample code"),(0,a.kt)("p",null,"If you want to quickly get started, then you can copy and paste the following code from each file into the corresponding files in your Hydrogen app. If the file doesn\u2019t yet exist, then you can create it in your Hydrogen app. This tutorial describes the sample code step by step:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx"},'// /src/routes/index.server.jsx\n\nimport { Suspense } from "react";\n\nimport FeaturedCollections from "../components/FeaturedCollections.server";\nimport { Layout } from "../components/Layout.server";\n\nexport default function Home() {\n  return (\n    <Layout>\n      <Suspense>\n        <FeaturedCollections />\n      </Suspense>\n    </Layout>\n  );\n}\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript?filename:",metastring:"'/src/App.server.jsx', title: 'App'","'/src/App.server.jsx',":!0,"title:":!0,"'App'":!0},"import React from 'react';\nimport renderHydrogen from '@shopify/hydrogen/entry-server';\nimport {\n  Router,\n  FileRoutes,\n  ShopifyProvider,\n} from '@shopify/hydrogen';\nimport {Suspense} from 'react';\n\nfunction App() {\n  return (\n    <Suspense fallback={null}>\n      <ShopifyProvider>\n          <Router>\n            <FileRoutes />\n          </Router>\n      </ShopifyProvider>\n    </Suspense>\n  );\n}\n\nexport default renderHydrogen(App);\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript?filename:",metastring:"'/src/components/Layout.server.jsx', title: 'Layout'","'/src/components/Layout.server.jsx',":!0,"title:":!0,"'Layout'":!0},'\nimport {\n  useShopQuery,\n  CacheLong,\n  gql,\n  useUrl,\n  Link,\n  Seo,\n} from "@shopify/hydrogen";\nimport { Suspense } from "react";\n\n/**\n * A server component that defines a structure and organization of a page that can be used in different parts of the Hydrogen app\n */\nexport function Layout({ children }) {\n  const { pathname } = useUrl();\n  const isHome = pathname === "/";\n\n  const {\n    data: { shop },\n  } = useShopQuery({\n    query: SHOP_QUERY,\n    cache: CacheLong(),\n    preload: true,\n  });\n\n  return (\n    <>\n      <Suspense>\n        <Seo\n          type="defaultSeo"\n          data={{\n            title: shop.name,\n            description: shop.description,\n          }}\n        />\n      </Suspense>\n      <div className="flex flex-col min-h-screen antialiased bg-neutral-50">\n        <div className="">\n          <a href="#mainContent" className="sr-only">\n            Skip to content\n          </a>\n        </div>\n        <header\n          role="banner"\n          className={`flex items-center h-16 p-6 md:p-8 lg:p-12 sticky backdrop-blur-lg z-40 top-0 justify-between w-full leading-none gap-4 antialiased transition shadow-sm ${\n            isHome ? "bg-black/80 text-white" : "bg-white/80"\n          }`}\n        >\n          <div className="flex gap-12">\n            <Link className="font-bold" to="/">\n              {shop.name}\n            </Link>\n          </div>\n        </header>\n\n        <main role="main" id="mainContent" className="flex-grow">\n          <Suspense>{children}</Suspense>\n        </main>\n      </div>\n    </>\n  );\n}\n\nconst SHOP_QUERY = gql`\n  query ShopInfo {\n    shop {\n      name\n      description\n    }\n  }\n`;\n\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript?filename:",metastring:"'/src/components/FeaturedCollections.server.jsx', title: 'FeaturedCollections'","'/src/components/FeaturedCollections.server.jsx',":!0,"title:":!0,"'FeaturedCollections'":!0},'import { Link, Image, gql, useShopQuery, CacheLong } from "@shopify/hydrogen";\n\nexport default function FeaturedCollections() {\n  const {\n    data: { collections },\n  } = useShopQuery({\n    query: QUERY,\n    cache: CacheLong(),\n  });\n\n  return (\n    <section className="w-full gap-4 md:gap-8 grid p-6 md:p-8 lg:p-12">\n      <h2 className="whitespace-pre-wrap max-w-prose font-bold text-lead">\n        Collections\n      </h2>\n      <div className="grid-flow-row grid gap-2 gap-y-6 md:gap-4 lg:gap-6 grid-cols-1 false  sm:grid-cols-3 false false">\n        {collections.nodes.map((collection) => {\n          return (\n            <Link key={collection.id} to={`/collections/${collection.handle}`}>\n              <div className="grid gap-4">\n                {collection?.image && (\n                  <Image\n                    className="rounded shadow-border overflow-clip inline-block aspect-[5/4] md:aspect-[3/2] object-cover"\n                    width={"100%"}\n                    height={336}\n                    alt={`Image of ${collection.title}`}\n                    data={collection.image}\n                  />\n                )}\n                <h2 className="whitespace-pre-wrap max-w-prose font-medium text-copy">\n                  {collection.title}\n                </h2>\n              </div>\n            </Link>\n          );\n        })}\n      </div>\n    </section>\n  );\n}\n\nconst QUERY = gql`\n  query FeaturedCollections {\n    collections(first: 3, query: "collection_type:smart", sortKey: UPDATED_AT) {\n      nodes {\n        id\n        title\n        handle\n        image {\n          altText\n          width\n          height\n          url\n        }\n      }\n    }\n  }\n`;\n')),(0,a.kt)("h2",{id:"step-1-visit-the-graphiql-explorer"},"Step 1: Visit the GraphiQL explorer"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Note:\nBy default, your Hydrogen app is connected to a Demo Store and uses a demo Storefront API access token. For the purposes of this tutorial, you'll use the Demo Store configuration. After you've finished this tutorial series, you can create a new Hydrogen app and ",(0,a.kt)("a",{parentName:"p",href:"/tutorials/configuration/"},"connect it to your own storefront"),".")),(0,a.kt)("p",null,"You can explore the ",(0,a.kt)("a",{parentName:"p",href:"https://shopify.dev/api/storefront"},"Storefront API")," and run test queries in your Hydrogen app. When you're running the Hydrogen local development server, you can load an interactive GraphiQL explorer that's connected to your shop."),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"With your development server running, visit the GraphiQL explorer at one of the following URLs:"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"http://localhost:3000/graphql"),(0,a.kt)("li",{parentName:"ul"},"http://localhost:3000/___graphql"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Run the following query in the GraphiQL explorer:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-graphql"},"query ShopInfo {\n  shop {\n    name\n    description\n  }\n}\n")))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"![GraphQL query run in the GraphiQL explorer](https://shopify.dev/assets/custom-storefronts/hydrogen/graphql-query.png)\n")),(0,a.kt)("h2",{id:"step-2-move-the-query-into-your-hydrogen-app"},"Step 2: Move the query into your Hydrogen app"),(0,a.kt)("p",null,"Now that you\u2019ve tested your query in the GraphiQL explorer and verified that it works, you can move the query into your Hydrogen app to display the shop name."),(0,a.kt)("p",null,"Hydrogen offers the ",(0,a.kt)("a",{parentName:"p",href:"/hooks/global/useshopquery/"},(0,a.kt)("inlineCode",{parentName:"a"},"useShopQuery"))," hook to fetch data from your storefront from within ",(0,a.kt)("a",{parentName:"p",href:"/hydrogen-v1/tutorials/react-server-components/#component-types"},"server components"),". In this step, you'll create a new ",(0,a.kt)("inlineCode",{parentName:"p"},"Layout")," component that renders your shop name, and you'll use the ",(0,a.kt)("inlineCode",{parentName:"p"},"useShopQuery")," hook within ",(0,a.kt)("inlineCode",{parentName:"p"},"Layout")," to pass in a GraphQL query that retrieves your shop's name."),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Tip:\nHydrogen contains a set of Shopify-specific commerce components, hooks, and utilities that help accelerate your development process. You can refer to the ",(0,a.kt)("a",{parentName:"p",href:"https://shopify.dev/docs/api/hydrogen"},"Hydrogen reference")," to determine which fields need to be queried for each component.")),(0,a.kt)("h3",{id:"create-a-layout-component"},"Create a ",(0,a.kt)("inlineCode",{parentName:"h3"},"Layout")," component"),(0,a.kt)("p",null,"Hydrogen is modelled after ",(0,a.kt)("a",{parentName:"p",href:"/tutorials/react-server-components/"},"React Server Components"),", an approach that offers an opinionated data-fetching and rendering workflow for React apps. It includes server, client, and shared component types."),(0,a.kt)("p",null,"The first ",(0,a.kt)("a",{parentName:"p",href:"/hydrogen-v1/tutorials/react-server-components/#component-types"},"server component")," that you\u2019ll build is a layout component. The layout component will be a server component because it doesn't require any client-side interactivity. Server components end in ",(0,a.kt)("inlineCode",{parentName:"p"},".server.jsx"),"."),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Create a new server component named ",(0,a.kt)("inlineCode",{parentName:"li"},"Layout.server.jsx")," and move your GraphQL query to the ",(0,a.kt)("inlineCode",{parentName:"li"},"useShopQuery")," hook:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx"},'// /src/components/Layout.server.jsx\n\nimport { useShopQuery, CacheLong, gql, useUrl, Link } from "@shopify/hydrogen";\n\n/**\n * A server component that defines a structure and organization of a page that can be used in different parts of the Hydrogen app\n*/\nexport function Layout({ children }) {\n  const { pathname } = useUrl();\n  const isHome = pathname === "/";\n\n  const {\n    data: { shop },\n  } = useShopQuery({\n    query: SHOP_QUERY,\n    cache: CacheLong(),\n    preload: true,\n  });\n\n  return (\n    <>\n      <div className="flex flex-col min-h-screen antialiased bg-neutral-50">\n        <div className="">\n          <a href="#mainContent" className="sr-only">\n            Skip to content\n          </a>\n        </div>\n        <header\n          role="banner"\n          className={`flex items-center h-16 p-6 md:p-8 lg:p-12 sticky backdrop-blur-lg z-40 top-0 justify-between w-full leading-none gap-4 antialiased transition shadow-sm ${\n            isHome ? "bg-black/80 text-white" : "bg-white/80"\n          }`}\n        >\n          <div className="flex gap-12">\n            <Link className="font-bold" to="/">\n              {shop.name}\n            </Link>\n          </div>\n        </header>\n\n        <main role="main" id="mainContent" className="flex-grow">\n          {children}\n        </main>\n      </div>\n    </>\n  );\n}\n\nconst SHOP_QUERY = gql`\n  query ShopInfo {\n    shop {\n      name\n      description\n    }\n  }\n`;\n')),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Import the ",(0,a.kt)("inlineCode",{parentName:"li"},"Layout")," component into the home page of your storefront and update the home page:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx"},'// /src/routes/index.server.jsx\n\nimport { Layout } from "../components/Layout.server";\n\nexport default function Home() {\n  return (\n    <Layout>\n      <div className="p-6 md:p-8 lg:p-12">\n        <h1 className="font-extrabold mb-4 text-5xl md:text-7xl">\n          Hello world!\n        </h1>\n        <p className="font-bold mb-3">Welcome to Hydrogen.</p>\n        <p>\n          Hydrogen is a front-end web development framework used for building\n          Shopify custom storefronts.\n        </p>\n      </div>\n    </Layout>\n  );\n}\n')),(0,a.kt)("p",null,"The home page renders the name of your shop and a ",(0,a.kt)("strong",{parentName:"p"},"Hello world!")," message:"),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://shopify.dev/assets/custom-storefronts/hydrogen/shop-name-hello-world.png",alt:"Home page with name of shop and Hello world messaged rendered"})),(0,a.kt)("h2",{id:"step-3-generate-seo-tags"},"Step 3: Generate SEO tags"),(0,a.kt)("p",null,"Hydrogen includes an ",(0,a.kt)("a",{parentName:"p",href:"/components/primitive/seo/"},"Seo")," client component that renders SEO information on a webpage. The ",(0,a.kt)("inlineCode",{parentName:"p"},"Seo")," client component uses the data from Storefront API to generate the ",(0,a.kt)("inlineCode",{parentName:"p"},"<head>")," tags that search engines look for."),(0,a.kt)("p",null,"To generate SEO tags for search engines, add an ",(0,a.kt)("a",{parentName:"p",href:"/components/primitive/seo/"},(0,a.kt)("inlineCode",{parentName:"a"},"Seo"))," component to your layout, and pass the shop ",(0,a.kt)("inlineCode",{parentName:"p"},"title")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"description")," to the ",(0,a.kt)("inlineCode",{parentName:"p"},"data")," prop:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx"},'// /src/components/Layout.server.jsx\n\n\nimport {\n  useShopQuery,\n  CacheLong,\n  gql,\n  useUrl,\n  Link,\n  Seo,\n} from "@shopify/hydrogen";\n\n/**\n * A server component that defines a structure and organization of a page that can be used in different parts of the Hydrogen app\n */\nexport function Layout({ children }) {\n  const { pathname } = useUrl();\n  const isHome = pathname === "/";\n\n  const {\n    data: { shop },\n  } = useShopQuery({\n    query: SHOP_QUERY,\n    cache: CacheLong(),\n    preload: true,\n  });\n\n  return (\n    <>\n      <Seo\n        type="defaultSeo"\n        data={{\n          title: shop.name,\n          description: shop.description,\n        }}\n      />\n      <div className="flex flex-col min-h-screen antialiased bg-neutral-50">\n        <div className="">\n          <a href="#mainContent" className="sr-only">\n            Skip to content\n          </a>\n        </div>\n        <header\n          role="banner"\n          className={`flex items-center h-16 p-6 md:p-8 lg:p-12 sticky backdrop-blur-lg z-40 top-0 justify-between w-full leading-none gap-4 antialiased transition shadow-sm ${\n            isHome ? "bg-black/80 text-white" : "bg-white/80"\n          }`}\n        >\n          <div className="flex gap-12">\n            <Link className="font-bold" to="/">\n              {shop.name}\n            </Link>\n          </div>\n        </header>\n\n        <main role="main" id="mainContent" className="flex-grow">\n          {children}\n        </main>\n      </div>\n    </>\n  );\n}\n\nconst SHOP_QUERY = gql`\n  query ShopInfo {\n    shop {\n      name\n      description\n    }\n  }\n`;\n\n')),(0,a.kt)("p",null,"If you inspect the page, then you can find the SEO tags that have been added into the ",(0,a.kt)("inlineCode",{parentName:"p"},"<head>")," tag:"),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://shopify.dev/assets/custom-storefronts/hydrogen/seo-tags.png",alt:"SEO tags that have been added into the head tag"})),(0,a.kt)("h2",{id:"step-4-fetch-collections"},"Step 4: Fetch collections"),(0,a.kt)("p",null,"Collections make it easier for customers to find products by category. For example, you might have a collection that features a subset of products."),(0,a.kt)("h3",{id:"create-a-featuredcollections-component"},"Create a ",(0,a.kt)("inlineCode",{parentName:"h3"},"FeaturedCollections")," component"),(0,a.kt)("p",null,"To list some collections on the home page, you\u2019ll create a ",(0,a.kt)("inlineCode",{parentName:"p"},"FeaturedCollections")," component. This component will query for the first three collections on your storefront."),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Create a new server component called ",(0,a.kt)("inlineCode",{parentName:"li"},"FeaturedCollections.server.jsx"),". Add the ",(0,a.kt)("a",{parentName:"li",href:"/hooks/global/useshopquery/"},"useShopQuery")," hook to your component so that you can query the Storefront API:")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Tip:\nIn the following code sample, you\u2019ll notice a reference to a ",(0,a.kt)("a",{parentName:"p",href:"/components/framework/link/"},(0,a.kt)("inlineCode",{parentName:"a"},"Link"))," component. The ",(0,a.kt)("inlineCode",{parentName:"p"},"Link")," component is used to navigate between routes. Because it renders an underlying ",(0,a.kt)("inlineCode",{parentName:"p"},"<a>")," element, all properties available to the ",(0,a.kt)("inlineCode",{parentName:"p"},"<a>")," element are also available to the ",(0,a.kt)("inlineCode",{parentName:"p"},"Link")," component.")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx"},'// /src/components/FeaturedCollections.server.jsx\n\nimport { Link, Image, gql, useShopQuery, CacheLong } from "@shopify/hydrogen";\n\nexport default function FeaturedCollections() {\n  const {\n    data: { collections },\n  } = useShopQuery({\n    query: QUERY,\n    cache: CacheLong(),\n  });\n\n  return (\n    <section className="w-full gap-4 md:gap-8 grid p-6 md:p-8 lg:p-12">\n      <h2 className="whitespace-pre-wrap max-w-prose font-bold text-lead">\n        Collections\n      </h2>\n      <div className="grid-flow-row grid gap-2 gap-y-6 md:gap-4 lg:gap-6 grid-cols-1 false  sm:grid-cols-3 false false">\n        {collections.nodes.map((collection) => {\n          return (\n            <Link key={collection.id} to={`/collections/${collection.handle}`}>\n              <div className="grid gap-4">\n                <h2 className="whitespace-pre-wrap max-w-prose font-medium text-copy">\n                  {collection.title}\n                </h2>\n              </div>\n            </Link>\n          );\n        })}\n      </div>\n    </section>\n  );\n}\n\nconst QUERY = gql`\n  query FeaturedCollections {\n    collections(first: 3, query: "collection_type:smart", sortKey: UPDATED_AT) {\n      nodes {\n        id\n        title\n        handle\n      }\n    }\n  }\n`;\n')),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Import the ",(0,a.kt)("inlineCode",{parentName:"li"},"FeaturedCollections")," component into the home page of your storefront:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx"},'// /src/routes/index.server.jsx\n\nimport FeaturedCollections from "../components/FeaturedCollections.server";\nimport { Layout } from "../components/Layout.server";\n\nexport default function Home() {\n  return (\n    <Layout>\n      <FeaturedCollections />\n    </Layout>\n  );\n}\n')),(0,a.kt)("p",null,"The home page renders the following featured collections section:"),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://shopify.dev/assets/custom-storefronts/hydrogen/three-collections.png",alt:"A featured collections section that contains three collections"})),(0,a.kt)("h3",{id:"fetch-collection-images"},"Fetch collection images"),(0,a.kt)("p",null,"Next, you'll fetch the image associated with each collection."),(0,a.kt)("p",null,"In ",(0,a.kt)("inlineCode",{parentName:"p"},"FeaturedCollections.server.jsx"),", update your GraphQL query to retrieve collection images and use an ",(0,a.kt)("inlineCode",{parentName:"p"},"Image")," component to display the image:"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Tip:\nIn the following code sample, you\u2019ll notice a reference to an ","[",(0,a.kt)("inlineCode",{parentName:"p"},"Image"),"]"," (/docs/components/primitive/image) component. The ",(0,a.kt)("inlineCode",{parentName:"p"},"Image")," component renders an image for the Storefront API's ",(0,a.kt)("a",{parentName:"p",href:"https://shopify.dev/api/storefront/latest/objects/image"},"Image object")," by using the ",(0,a.kt)("inlineCode",{parentName:"p"},"data")," prop, or a custom location by using the ",(0,a.kt)("inlineCode",{parentName:"p"},"src")," prop.")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx"},'// /src/components/FeaturedCollections.server.jsx\n\nimport { Link, Image, gql, useShopQuery, CacheLong } from "@shopify/hydrogen";\n\nexport default function FeaturedCollections() {\n  const {\n    data: { collections },\n  } = useShopQuery({\n    query: QUERY,\n    cache: CacheLong(),\n  });\n\n  return (\n    <section className="w-full gap-4 md:gap-8 grid p-6 md:p-8 lg:p-12">\n      <h2 className="whitespace-pre-wrap max-w-prose font-bold text-lead">\n        Collections\n      </h2>\n      <div className="grid-flow-row grid gap-2 gap-y-6 md:gap-4 lg:gap-6 grid-cols-1 false  sm:grid-cols-3 false false">\n        {collections.nodes.map((collection) => {\n          return (\n            <Link key={collection.id} to={`/collections/${collection.handle}`}>\n              <div className="grid gap-4">\n                {collection?.image && (\n                  <Image\n                    className="rounded shadow-border overflow-clip inline-block aspect-[5/4] md:aspect-[3/2] object-cover"\n                    width={"100%"}\n                    height={336}\n                    alt={`Image of ${collection.title}`}\n                    data={collection.image}\n                  />\n                )}\n                <h2 className="whitespace-pre-wrap max-w-prose font-medium text-copy">\n                  {collection.title}\n                </h2>\n              </div>\n            </Link>\n          );\n        })}\n      </div>\n    </section>\n  );\n}\n\nconst QUERY = gql`\n  query FeaturedCollections {\n    collections(first: 3, query: "collection_type:smart", sortKey: UPDATED_AT) {\n      nodes {\n        id\n        title\n        handle\n        image {\n          altText\n          width\n          height\n          url\n        }\n      }\n    }\n  }\n`;\n')),(0,a.kt)("p",null,"The home page renders the following featured collections section that contains the images of the first three collections:"),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://shopify.dev/assets/custom-storefronts/hydrogen/collection-images.png",alt:"A featured collections section that contains the images of the first three collections"})),(0,a.kt)("h2",{id:"step-5-improve-the-loading-sequence-with-suspense"},"Step 5: Improve the loading sequence with Suspense"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"/tutorials/streaming-ssr/"},"Suspense")," is a feature of React that governs the appearance and behavior of placeholder content inside components while asynchronous data-fetching is in progress. React 18 introduced ",(0,a.kt)("a",{parentName:"p",href:"https://nextjs.org/docs/advanced-features/react-18/streaming"},"Suspense for data fetching to complement streaming SSR"),". Learn more about ",(0,a.kt)("a",{parentName:"p",href:"/hydrogen-v1/tutorials/best-practices/performance#suspense-boundaries"},"how to use Suspense"),"."),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"FeaturedCollections")," is a server component that fetches data from the Storefront API. Until the component finishes loading, React looks for the closest ",(0,a.kt)("inlineCode",{parentName:"p"},"Suspense")," boundary to display the specified loading fallback."),(0,a.kt)("p",null,"Currently, the closest Suspense ancestor wraps the entire app in ",(0,a.kt)("inlineCode",{parentName:"p"},"App.server.jsx"),". By wrapping ",(0,a.kt)("inlineCode",{parentName:"p"},"FeaturedCollections")," in its own Suspense boundary, it won't block other components on the page."),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Wrap the ",(0,a.kt)("inlineCode",{parentName:"li"},"FeaturedCollections")," component in a Suspense component:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx"},'// /src/routes/index.server.jsx\n\nimport { Suspense } from "react";\n\nimport FeaturedCollections from "../components/FeaturedCollections.server";\nimport { Layout } from "../components/Layout.server";\n\nexport default function Home() {\n  return (\n    <Layout>\n      <Suspense>\n        <FeaturedCollections />\n      </Suspense>\n    </Layout>\n  );\n}\n')),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Similarly, update your Layout component to wrap ",(0,a.kt)("inlineCode",{parentName:"li"},"Seo")," and ",(0,a.kt)("inlineCode",{parentName:"li"},"{ children }")," in ",(0,a.kt)("inlineCode",{parentName:"li"},"Suspense")," components:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx"},'// /src/components/Layout.server.jsx\n\n\nimport {\n  useShopQuery,\n  CacheLong,\n  gql,\n  useUrl,\n  Link,\n  Seo,\n} from "@shopify/hydrogen";\nimport { Suspense } from "react";\n\n/**\n * A server component that defines a structure and organization of a page that can be used in different parts of the Hydrogen app\n */\nexport function Layout({ children }) {\n  const { pathname } = useUrl();\n  const isHome = pathname === "/";\n\n  const {\n    data: { shop },\n  } = useShopQuery({\n    query: SHOP_QUERY,\n    cache: CacheLong(),\n  });\n\n  return (\n    <>\n      <Suspense>\n        <Seo\n          type="defaultSeo"\n          data={{\n            title: shop.name,\n            description: shop.description,\n          }}\n        />\n      </Suspense>\n      <div className="flex flex-col min-h-screen antialiased bg-neutral-50">\n        <div className="">\n          <a href="#mainContent" className="sr-only">\n            Skip to content\n          </a>\n        </div>\n        <header\n          role="banner"\n          className={`flex items-center h-16 p-6 md:p-8 lg:p-12 sticky backdrop-blur-lg z-40 top-0 justify-between w-full leading-none gap-4 antialiased transition shadow-sm ${\n            isHome ? "bg-black/80 text-white" : "bg-white/80"\n          }`}\n        >\n          <div className="flex gap-12">\n            <Link className="font-bold" to="/">\n              {shop.name}\n            </Link>\n          </div>\n        </header>\n\n        <main role="main" id="mainContent" className="flex-grow">\n          <Suspense>{children}</Suspense>\n        </main>\n      </div>\n    </>\n  );\n}\n\nconst SHOP_QUERY = gql`\n  query ShopInfo {\n    shop {\n      name\n      description\n    }\n  }\n`;\n\n')),(0,a.kt)("h2",{id:"next-steps"},"Next steps"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Learn how to ",(0,a.kt)("a",{parentName:"li",href:"custom-storefronts/hydrogen/getting-started/tutorial/collections"},"build a collection page"),".")))}u.isMDXComponent=!0}}]);