"use strict";(self.webpackChunkdocs_v_1=self.webpackChunkdocs_v_1||[]).push([[3788],{5680:(e,r,t)=>{t.d(r,{xA:()=>u,yg:()=>y});var n=t(6540);function o(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function a(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function s(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?a(Object(t),!0).forEach((function(r){o(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function p(e,r){if(null==e)return{};var t,n,o=function(e,r){if(null==e)return{};var t,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)t=a[n],r.indexOf(t)>=0||(o[t]=e[t]);return o}(e,r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)t=a[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var i=n.createContext({}),l=function(e){var r=n.useContext(i),t=r;return e&&(t="function"==typeof e?e(r):s(s({},r),e)),t},u=function(e){var r=l(e.components);return n.createElement(i.Provider,{value:r},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var r=e.children;return n.createElement(n.Fragment,{},r)}},g=n.forwardRef((function(e,r){var t=e.components,o=e.mdxType,a=e.originalType,i=e.parentName,u=p(e,["components","mdxType","originalType","parentName"]),c=l(t),g=o,y=c["".concat(i,".").concat(g)]||c[g]||d[g]||a;return t?n.createElement(y,s(s({ref:r},u),{},{components:t})):n.createElement(y,s({ref:r},u))}));function y(e,r){var t=arguments,o=r&&r.mdxType;if("string"==typeof e||o){var a=t.length,s=new Array(a);s[0]=g;var p={};for(var i in r)hasOwnProperty.call(r,i)&&(p[i]=r[i]);p.originalType=e,p[c]="string"==typeof e?e:o,s[1]=p;for(var l=2;l<a;l++)s[l]=t[l];return n.createElement.apply(null,s)}return n.createElement.apply(null,t)}g.displayName="MDXCreateElement"},9568:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>i,contentTitle:()=>s,default:()=>d,frontMatter:()=>a,metadata:()=>p,toc:()=>l});var n=t(8168),o=(t(6540),t(5680));const a={},s="Server props",p={unversionedId:"tutorials/server-props",id:"tutorials/server-props",title:"Server props",description:"Hydrogen 2.0 is out now. These archival Hydrogen 1.0 docs are provided only to assist developers during their upgrade process. Please migrate as soon as possible.",source:"@site/docs/tutorials/server-props.md",sourceDirName:"tutorials",slug:"/tutorials/server-props",permalink:"/hydrogen-v1/tutorials/server-props",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"hydrogen",previous:{title:"Manage SEO",permalink:"/hydrogen-v1/tutorials/seo/manage-seo"},next:{title:"Sessions",permalink:"/hydrogen-v1/tutorials/sessions/"}},i={},l=[{value:"How server props work",id:"how-server-props-work",level:2},{value:"Example",id:"example",level:2},{value:"Related hooks",id:"related-hooks",level:2},{value:"Next steps",id:"next-steps",level:2}],u={toc:l},c="wrapper";function d(e){let{components:r,...t}=e;return(0,o.yg)(c,(0,n.A)({},u,t,{components:r,mdxType:"MDXLayout"}),(0,o.yg)("h1",{id:"server-props"},"Server props"),(0,o.yg)("admonition",{type:"tip"},(0,o.yg)("p",{parentName:"admonition"},"Hydrogen 2.0 is out now. These archival Hydrogen 1.0 docs are provided only to assist developers during their upgrade process. Please ",(0,o.yg)("a",{parentName:"p",href:"/migrate"},"migrate")," as soon as possible.")),(0,o.yg)("p",null,"As you build your Hydrogen app with ",(0,o.yg)("a",{parentName:"p",href:"/tutorials/react-server-components/"},"React Server Components"),", you might need to update ",(0,o.yg)("inlineCode",{parentName:"p"},"props")," on the server. Sharing data between the client and server is important for common tasks, such as ",(0,o.yg)("a",{parentName:"p",href:"/tutorials/routing/"},"page routing"),"."),(0,o.yg)("p",null,"This guide describes how to manage server props during your development process."),(0,o.yg)("h2",{id:"how-server-props-work"},"How server props work"),(0,o.yg)("p",null,"Server ",(0,o.yg)("inlineCode",{parentName:"p"},"props")," are props that are passed to your root server component route. Hydrogen provides a ",(0,o.yg)("a",{parentName:"p",href:"/hooks/global/useserverprops/"},(0,o.yg)("inlineCode",{parentName:"a"},"useServerProps"))," hook with a ",(0,o.yg)("inlineCode",{parentName:"p"},"setServerProps")," helper function, which allows you to re-render the server component with new ",(0,o.yg)("inlineCode",{parentName:"p"},"props"),". This is useful to paginate within collections, switch product variants, or do anything that requires new data from the server."),(0,o.yg)("p",null,"For example, you can use geolocation co-ordinates as server props to provide a new hydrated experience for the current location:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},"// GeoLocate.client.jsx\n\nnavigator.geolocation.getCurrentPosition((data) => {\n  setServerProps('geoCoordinates', data);\n});\n")),(0,o.yg)("p",null,"Whenever you modify the props with ",(0,o.yg)("inlineCode",{parentName:"p"},"setServerProps()"),", Hydrogen automatically makes a hydration request to the server component. Your app tree is updated based on the result of that hydration request."),(0,o.yg)("h2",{id:"example"},"Example"),(0,o.yg)("p",null,"The following example shows a page that queries a specific product ID based on server props:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-jsx"},"// MyPage.server.jsx\n\nexport default function MyPage({selectedProductId}) {\n  const {data} = useShopQuery({\n    query: QUERY,\n    variables: {productId: selectedProductId},\n  });\n  const {product} = data;\n\n  return (\n    <>\n      <div>Selected product is {product.title}</div>\n      <ProductSelector selectedProductId={selectedProductId} />\n    </>\n  );\n}\n")),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-jsx"},"// ProductSelector.client.jsx\n\nimport {useServerProps} from '@shopify/hydrogen';\n\nexport default function ProductSelector({selectedProductId}) {\n  const {setServerProps, pending} = useServerProps();\n\n  return (\n    <div>\n      {pending ? <p>Loading...</p> : null}\n      <button\n        onClick={() => {\n          setServerProps('selectedProductId', 123);\n        }}\n      >\n        Select Shoes\n      </button>\n      <button\n        onClick={() => {\n          setServerProps('selectedProductId', 456);\n        }}\n      >\n        Select Dresses\n      </button>\n    </div>\n  );\n}\n")),(0,o.yg)("p",null,"When the user navigates to a new page in your app, the server props will reset. This is important because if the user navigates to another product, then the selected variant of the previous product shouldn't apply to the new product page."),(0,o.yg)("h2",{id:"related-hooks"},"Related hooks"),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("a",{parentName:"li",href:"/hooks/global/useserverprops/"},(0,o.yg)("inlineCode",{parentName:"a"},"useServerProps")))),(0,o.yg)("h2",{id:"next-steps"},"Next steps"),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},"Learn about ",(0,o.yg)("a",{parentName:"li",href:"/tutorials/react-server-components/"},"React Server Components"),", an opinionated data-fetching and rendering workflow for React apps."),(0,o.yg)("li",{parentName:"ul"},"Learn how to ",(0,o.yg)("a",{parentName:"li",href:"/tutorials/react-server-components/work-with-rsc/"},"work with React Server Components"),".")))}d.isMDXComponent=!0}}]);